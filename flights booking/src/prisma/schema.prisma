generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
}

model airplane {
  id          Int    @id @default(autoincrement())
  modelNumber String @unique()
  capacity    Int    @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  flights Flight[]
  seats Seat[]

}

model user {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  email     String   @unique(map: "User_email_key")
  name      String?
}


model Cities{
  id   Int    @id @default(autoincrement())
  city String @unique()
  airports Airport[]
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

}

model Airport{
  id   Int    @id @default(autoincrement())
  name String @unique 
  code String @unique
  address String? @unique
  cityId Int @unique()
  city      Cities @relation(fields: [cityId], references: [id],onDelete: Cascade, onUpdate: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  departures Flight[] @relation("DepartureAirport")
  arrivals Flight[] @relation("ArrivalAirport")

}

model Flight{
  id Int @id @default(autoincrement())
  flightNumber String @unique
  airplaneId Int
  airplane airplane @relation(fields:[airplaneId],references:[id],onDelete: Cascade)
  departureAirportId String  
  departureAirport Airport  @relation( "DepartureAirport",fields: [departureAirportId],references: [code],onDelete: Cascade)
  arrivalAirportId String 
  arrivalAirport Airport @relation("ArrivalAirport",fields:[arrivalAirportId],references: [code],onDelete: Cascade)
  arrivalTime DateTime
  departureTime DateTime
  price Int
  boardingGate String?
  totalSeats Int
}


model Seat{
  id Int @id @default(autoincrement())
  airplaneId Int
  airplane airplane @relation(fields:[airplaneId],references: [id], onDelete: Cascade)
  row Int
  col String
  type SeatType @default(ECONOMY) 
  createdAt  DateTime @default(now())
  updatedAt  DateTime @default(now())
}


enum SeatType {
  BUSINESS
  ECONOMY
  PREMIUM_ECONOMY
  FIRST_CLASS
}